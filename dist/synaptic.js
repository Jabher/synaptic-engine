!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.synaptic=e():t.synaptic=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ConvNet=e.LSTM=e.FeedForward=e.Network=e.Engine=void 0;var i=r(1),o=n(i),a=r(2),s=n(a),u=r(3),c=n(u),f=r(4),l=n(f);e.Engine=o.default,e.Network=s.default,e.FeedForward=c.default,e.LSTM=l.default,e.ConvNet=l.default},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t){return 1/(1+Math.exp(-t))}function i(t){var e=n(t);return e*(1-e)}function o(t,e){return t.reduce(function(t,r){return t+e(r)},0)}function a(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var n,i=e.reduce(function(t,e){return t.concat(e||[])},[]),o={},a=[];for(n=0;n<i.length;o[i[n++]]=1);for(n in o)a.push(+n);return a}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();e.LOGISTIC_SIGMOID=n,e.LOGISTIC_SIGMOID_DERIVATIVE=i;var u={bias:!0,generator:function(){return 2*Math.random()-1}},c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=e.bias,i=e.generator;r(this,t),this.state={},this.weight={},this.gain={},this.activation={},this.elegibilityTrace={},this.extendedElegibilityTrace={},this.errorResponsibility={},this.projectedErrorResponsibility={},this.gatedErrorResponsibility={},this.activationFunction={},this.activationFunctionDerivative={},this.inputsOf={},this.projectedBy={},this.gatersOf={},this.gatedBy={},this.inputsOfGatedBy={},this.projectionSet={},this.gateSet={},this.inputSet={},this.derivativeTerm={},this.connections=[],this.gates=[],this.learningRate=.1,this.size=0,this.random=i,this.biasUnit=null,n&&(this.biasUnit=this.addUnit(),this.activation[this.biasUnit]=1)}return s(t,[{key:"activate",value:function(t,e){var r=t,n=this.state,i=this.weight,a=this.gain,s=this.activation,u=this.activationFunction,c=this.activationFunctionDerivative,f=this.elegibilityTrace,l=this.extendedElegibilityTrace;if("undefined"!=typeof e)s[r]=e;else{n[r]=a[r][r]*i[r][r]*n[r]+o(this.inputSet[r],function(t){return a[r][t]*i[r][t]*s[t]}),s[r]=u[r](n[r]);var h=!0,y=!1,p=void 0;try{for(var d,g=this.inputSet[r][Symbol.iterator]();!(h=(d=g.next()).done);h=!0){var v=d.value;f[r][v]=a[r][r]*i[r][r]*f[r][v]+a[r][v]*s[v];var b=!0,m=!1,O=void 0;try{for(var E,_=this.gatedBy[r][Symbol.iterator]();!(b=(E=_.next()).done);b=!0){var T=E.value;l[r][v][T]=a[T][T]*i[T][T]*l[r][v][T]+c[r](n[r])*f[r][v]*this.bigParenthesisTerm(r,T)}}catch(t){m=!0,O=t}finally{try{!b&&_.return&&_.return()}finally{if(m)throw O}}}}catch(t){y=!0,p=t}finally{try{!h&&g.return&&g.return()}finally{if(y)throw p}}var w=!0,L=!1,j=void 0;try{for(var S,x=this.gatedBy[t][Symbol.iterator]();!(w=(S=x.next()).done);w=!0){var G=S.value,B=!0,k=!1,R=void 0;try{for(var P,C=this.inputsOfGatedBy[G][t][Symbol.iterator]();!(B=(P=C.next()).done);B=!0){var N=P.value;a[G][N]=s[t]}}catch(t){k=!0,R=t}finally{try{!B&&C.return&&C.return()}finally{if(k)throw R}}}}catch(t){L=!0,j=t}finally{try{!w&&x.return&&x.return()}finally{if(L)throw j}}}return s[r]}},{key:"propagate",value:function(t,e){var r=this,n=t,i=this.state,a=this.weight,s=this.gain,u=this.activation,c=this.activationFunctionDerivative,f=this.errorResponsibility,l=this.projectedErrorResponsibility,h=this.gatedErrorResponsibility,y=this.learningRate,p=this.elegibilityTrace,d=this.extendedElegibilityTrace,g=this.projectionSet,v=this.gateSet;"undefined"!=typeof e?f[n]=l[n]=e-u[n]:(l[n]=c[n](i[n])*o(g[n],function(t){return f[t]*s[t][n]*a[t][n]}),h[n]=c[n](i[n])*o(v[n],function(t){return f[t]*r.bigParenthesisTerm(n,t)}),f[n]=l[n]+h[n]);var b=!0,m=!1,O=void 0;try{for(var E,_=function(){var t=E.value;a[n][t]+=y*l[n]*p[n][t]+y*o(v[n],function(e){return f[e]*d[n][t][e]})},T=this.inputSet[n][Symbol.iterator]();!(b=(E=T.next()).done);b=!0)_()}catch(t){m=!0,O=t}finally{try{!b&&T.return&&T.return()}finally{if(m)throw O}}}},{key:"bigParenthesisTerm",value:function(t,e){var r=this.weight,n=this.state,i=this.activation,a=this.derivativeTerm[e][t],s=this.inputsOfGatedBy[e][t];return a*r[e][e]*n[e]+o(s,function(t){return r[e][t]*i[t]})}},{key:"addUnit",value:function(){var t=this.size;return this.state[t]=random(),this.weight[t]={},this.gain[t]={},this.elegibilityTrace[t]={},this.extendedElegibilityTrace[t]={},this.activation[t]=0,this.weight[t][t]=0,this.gain[t][t]=1,this.elegibilityTrace[t][t]=0,this.extendedElegibilityTrace[t][t]={},this.activationFunction[t]=n,this.activationFunctionDerivative[t]=i,this.errorResponsibility[t]=0,this.projectedErrorResponsibility[t]=0,this.gatedErrorResponsibility[t]=0,this.inputsOf[t]=[],this.projectedBy[t]=[],this.gatersOf[t]=[],this.gatedBy[t]=[],this.inputsOfGatedBy[t]={},this.derivativeTerm[t]={},this.inputSet[t]=[],this.projectionSet[t]=[],this.gateSet[t]=[],this.size++,null!=this.biasUnit&&this.addConnection(this.biasUnit,t),t}},{key:"addConnection",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.connections.some(function(r){return r.from===t&&r.to===e})){this.connections.push({from:t,to:e});var n=e,i=t,o=t===e;this.gain[n][i]=1,this.weight[n][i]=o?1:null==r?this.random():r,this.elegibilityTrace[n][i]=0,this.extendedElegibilityTrace[n][i]={},this.track(e),this.track(t)}}},{key:"addGate",value:function(t,e,r){var n=this.gates.some(function(r){return r.from===t&&r.to===e}),i=t===this.biasUnit;n||i||(this.gates.push({from:t,to:e,gater:r}),this.track(e),this.track(t),this.track(r))}},{key:"track",value:function(t){var e=this;this.inputsOf[t]=a(this.connections.filter(function(e){return e.to===t}).map(function(t){return t.from})),this.projectedBy[t]=a(this.connections.filter(function(e){return e.from===t}).map(function(t){return t.to})),this.gatersOf[t]=a(this.gates.filter(function(e){return e.to===t}).map(function(t){return t.gater})),this.gatedBy[t]=a(this.gates.filter(function(e){return e.gater===t}).map(function(t){return t.to})),this.inputsOf[t].forEach(function(r){e.gatedBy[t].forEach(function(n){e.extendedElegibilityTrace[t][r][n]=0})}),this.projectedBy[t].forEach(function(r){e.gatedBy[r].forEach(function(n){e.extendedElegibilityTrace[r][t][n]=0})}),this.gatersOf[t].forEach(function(r){e.inputsOf[r].forEach(function(n){e.extendedElegibilityTrace[r][n][t]=0})}),this.inputsOf[t].forEach(function(r){e.gatersOf[t].forEach(function(n){e.inputsOfGatedBy[t][n]=a(e.inputsOfGatedBy[t][n],e.gates.filter(function(e){return e.gater===n&&e.to===t&&e.from===r&&e.to!==e.from}).map(function(t){return t.from}))})}),this.gatedBy[t].forEach(function(r){e.inputsOf[r].forEach(function(n){e.inputsOfGatedBy[r][t]=a(e.inputsOfGatedBy[r][t],e.gates.filter(function(e){return e.gater===t&&e.to===r&&e.from===n&&e.to!==e.from}).map(function(t){return t.from}))})}),this.gatedBy[t].forEach(function(r){e.derivativeTerm[r][t]=e.gates.some(function(e){return e.to===r&&e.from===r&&e.gater===t})?1:0}),this.gatersOf[t].forEach(function(r){e.derivativeTerm[t][r]=e.gates.some(function(e){return e.to===t&&e.from===t&&e.gater===r})?1:0}),this.inputSet[t]=this.inputsOf[t].filter(function(e){return e!==t}),this.projectionSet[t]=this.projectedBy[t].filter(function(e){return e>t}),this.gateSet[t]=this.gatedBy[t].filter(function(e){return e>t})}}]),t}();e.default=c},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){return e.map(function(r,n){var i=e.slice(0,n).reduce(function(t,e){return t*e},1);return t/i%r|0})}function c(t,e,r,n){for(var i=r;i>=0;i--)if(i in t&&i in e){var o=t[i],a=e[i];if(o<a-n||o>a+n)return!1}return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.gateTypes=e.connectionTypes=void 0;var f=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},h=r(1),y=n(h),p=e.connectionTypes={DENSE:function(){return function(t,e){return!0}},SELF:function(){return function(t,e){return t===e}},CONVOLUTION:function(t,e,r){return function(n,i){var o=u(n,t),a=u(i,e),s=Math.max(t.length,dimensionB.length);return c(o,a,s,r)}}},d=e.gateTypes={INBOUND:"The gater layer will gate all the inbound connections coming into the gated layer",OUTBOUND:"The gater layer will gate all the outbound connections coming from the gated layer",SELF:"The gater layer will gate all the self-connections of the gated layer"},g=function(t){function e(){o(this,e);var t=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.layers=[],t}return s(e,t),f(e,[{key:"activate",value:function(){for(var t=this,r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];var a=[];return this.layers.forEach(function(r,o){0===o?r.forEach(function(r,i){return l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"activate",t).call(t,r,n[i])}):o<t.layers.length-1?r.forEach(function(r){return l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"activate",t).call(t,r)}):a=r.reduce(function(r,n){return[].concat(i(r),[l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"activate",t).call(t,n)])},[])}),a}},{key:"propagate",value:function(){for(var t=this,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];this.layers.slice(1).reverse().forEach(function(r,i){var o=0===i;r.concat().reverse().forEach(function(r,i){o?l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"propagate",t).call(t,r,n[i]):l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"propagate",t).call(t,r)})})}},{key:"addLayer",value:function(t){for(var e=[],r=0;r<t;r++){var n=this.addUnit();e.push(n)}return this.layers.push(e),e}},{key:"connectLayers",value:function(t,e,r){var n=this;"undefined"==typeof r&&(r=t!==e?p.DENSE():p.SELF()),t.forEach(function(t,i){e.forEach(function(e,o){r(i,o)&&n.addConnection(t,e)})})}},{key:"gateLayer",value:function(t,e,r){var n=this;if(t.length!==e.length)throw new Error("Gater and Gated layers must be the same length.");for(var i=void 0,o=void 0,a=void 0,s=function(s){switch(r){case d.SELF:i=e[s],o=e[s],a=t[s],n.addGate(i,o,a);break;case d.INBOUND:o=e[s],a=t[s],n.connections.filter(function(t){return t.to===o}).filter(function(t){return t.from!==o}).map(function(t){return t.from}).forEach(function(t){return n.addGate(t,o,a)});break;case d.OUTBOUND:e.forEach(function(r){i=e[s],a=t[s],n.connections.filter(function(t){return t.from===i}).filter(function(t){return t.to!==i}).map(function(t){return t.to}).forEach(function(t){return n.addGate(i,t,a)})})}},u=0;u<t.length;u++)s(u)}},{key:"toJSON",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e={layers:this.layers,state:this.state,weight:this.weight,gain:this.gain,activation:this.activation,elegibilityTrace:this.elegibilityTrace,extendedElegibilityTrace:this.extendedElegibilityTrace,errorResponsibility:this.errorResponsibility,projectedErrorResponsibility:this.projectedErrorResponsibility,gatedErrorResponsibility:this.gatedErrorResponsibility,connections:this.connections,gates:this.gates,size:this.size};return t?JSON.stringify(e):e}},{key:"clone",value:function(){return e.fromJSON(this.toJSON())}}],[{key:"fromJSON",value:function(t){for(var r="string"==typeof t?JSON.parse(t):t,n=new e,i=0;i<r.size;i++)n.addUnit();return r.connections.forEach(function(t){return n.addConnection(t.from,t.to)}),r.gates.forEach(function(t){return n.addGate(t.from,t.to,t.gater)}),n.layers=r.layers,n.state=r.state,n.weight=r.weight,n.gain=r.gain,n.activation=r.activation,n.elegibilityTrace=r.elegibilityTrace,n.extendedElegibilityTrace=r.extendedElegibilityTrace,n.errorResponsibility=r.errorResponsibility,n.projectedErrorResponsibility=r.projectedErrorResponsibility,n.gatedErrorResponsibility=r.gatedErrorResponsibility,n.connections=r.connections,n.gates=r.gates,n}}]),e}(y.default);e.default=g},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=r(2),u=n(s),c=function(t){function e(t,r,n){i(this,e);var a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.inputLayer=a.addLayer(t),a.hiddenLayer=a.addLayer(r),a.outputLayer=a.addLayer(n),a.connectLayers(a.inputLayer,a.hiddenLayer),a.connectLayers(a.hiddenLayer,a.outputLayer),a}return a(e,t),e}(u.default);e.default=c},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=r(2),u=n(s),c=s.gateTypes.INBOUND,f=s.gateTypes.OUTBOUND,l=s.gateTypes.SELF,h=function(t){function e(t,r,n){i(this,e);var a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.inputLayer=a.addLayer(t),a.inputGate=a.addLayer(r),a.forgetGate=a.addLayer(r),a.memoryCell=a.addLayer(r),a.outputGate=a.addLayer(r),a.outputLayer=a.addLayer(n),a.connectLayers(a.inputLayer,a.memoryCell),a.connectLayers(a.memoryCell,a.memoryCell),a.connectLayers(a.memoryCell,a.outputLayer),a.connectLayers(a.inputLayer,a.inputGate),a.connectLayers(a.inputLayer,a.forgetGate),a.connectLayers(a.inputLayer,a.outputGate),a.connectLayers(a.inputLayer,a.outputLayer),a.gateLayer(a.inputGate,a.memoryCell,c),a.gateLayer(a.forgetGate,a.memoryCell,l),a.gateLayer(a.outputGate,a.memoryCell,f),a.connectLayers(a.memoryCell,a.inputGate),a.connectLayers(a.memoryCell,a.forgetGate),a.connectLayers(a.memoryCell,a.outputGate),a}return a(e,t),e}(u.default);e.default=h}])});